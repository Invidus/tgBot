# Food Recognition Service

–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Ö –ë–ñ–£ (–±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã).

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ª–æ—Ä–∏–π –∏ –ë–ñ–£
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Open Food Facts –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ü§ñ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### 1. Yandex Vision API (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è –†–æ—Å—Å–∏–∏) ‚≠ê –ë–ï–°–ü–õ–ê–¢–ù–û
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ë–ï–°–ü–õ–ê–¢–ù–û (–¥–æ 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è `YANDEX_VISION_API_KEY` –∏ `YANDEX_VISION_FOLDER_ID`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –†–æ—Å—Å–∏–∏, —Ö–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

### 2. Google Vision API ‚≠ê –ë–ï–°–ü–õ–ê–¢–ù–û (–¥–æ 1000/–º–µ—Å—è—Ü)
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü, –∑–∞—Ç–µ–º $1.50 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è `GOOGLE_VISION_API_KEY`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –•–æ—Ä–æ—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç

### 3. Hugging Face (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π) ‚≠ê –ë–ï–°–ü–õ–ê–¢–ù–û
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `HUGGINGFACE_API_TOKEN`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### 4. OpenAI GPT-4 Vision (–ø–ª–∞—Ç–Ω–æ, —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~$0.01-0.03 –∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (~$10-30 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è `OPENAI_API_KEY`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –°–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –í—ã–±–µ—Ä–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä

–í `.env` —Ñ–∞–π–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```bash
AI_PROVIDER=yandex  # –∏–ª–∏ google, openai, huggingface
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Yandex Vision (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –†–æ—Å—Å–∏–∏ - –ë–ï–°–ü–õ–ê–¢–ù–û!)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ [Yandex Cloud](https://console.cloud.yandex.ru/)
2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ (folder) –≤ –æ–±–ª–∞–∫–µ
3. –ü–æ–ª—É—á–∏—Ç–µ Folder ID –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
4. –ü–æ–ª—É—á–∏—Ç–µ OAuth —Ç–æ–∫–µ–Ω –Ω–∞ https://oauth.yandex.ru/
5. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
AI_PROVIDER=yandex
YANDEX_VISION_API_KEY=–≤–∞—à_oauth_—Ç–æ–∫–µ–Ω
YANDEX_VISION_FOLDER_ID=–≤–∞—à_folder_id
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Google Vision (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1000/–º–µ—Å—è—Ü)

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Google Cloud Console
2. –í–∫–ª—é—á–∏—Ç–µ Vision API
3. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á
4. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
GOOGLE_VISION_API_KEY=your_api_key
GOOGLE_VISION_PROJECT_ID=your_project_id
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ OpenAI (–ø–ª–∞—Ç–Ω–æ, —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)

1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –Ω–∞ https://platform.openai.com/api-keys
2. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å (–º–∏–Ω–∏–º—É–º $5)
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
AI_PROVIDER=openai
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4o
```

### 5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Hugging Face (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π, –±–µ—Å–ø–ª–∞—Ç–Ω–æ)

1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ https://huggingface.co/settings/tokens
2. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
AI_PROVIDER=huggingface
HUGGINGFACE_API_TOKEN=hf_...
```

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç fallback

–°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

1. **–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä** (—É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ `AI_PROVIDER`)
2. **–î—Ä—É–≥–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã** (–µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª)
3. **Hugging Face** (–≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑–µ—Ä–≤)

## üìä API

### POST /recognize

–†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –±–ª—é–¥–æ –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "imageUrl": "https://example.com/image.jpg",
  "chatId": 123456789
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "dishName": "–ø–∏—Ü—Ü–∞",
  "confidence": 95,
  "calories": 266,
  "protein": 11,
  "carbs": 33,
  "fats": 10,
  "source": "Open Food Facts",
  "provider": "OpenAI",
  "alternatives": []
}
```

### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞.

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–î–ª—è –†–æ—Å—Å–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Yandex Vision API (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü)
- **–î–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Google Vision API (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1,000/–º–µ—Å—è—Ü)
- **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ OpenAI GPT-4 Vision (—Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π, –Ω–æ –ø–ª–∞—Ç–Ω–æ)
- **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—ç–∫–æ–Ω–æ–º–∏–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Hugging Face (–ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ)

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ "–í—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω API –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ —Å—á–µ—Ç—É OpenAI/Google
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### OpenAI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `OPENAI_API_KEY` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://platform.openai.com/account/usage
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª—å `gpt-4o` –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –≤–∞—à–µ–º –∞–∫–∫–∞—É–Ω—Ç–µ

### Google Vision –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Vision API –≤–∫–ª—é—á–µ–Ω –≤ Google Cloud Console
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã –Ω–∞ https://console.cloud.google.com/apis/api/vision.googleapis.com/quotas
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–ª—é—á –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### Yandex Vision –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `YANDEX_VISION_FOLDER_ID` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ OAuth —Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Vision API –≤–∫–ª—é—á–µ–Ω –≤ Yandex Cloud
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ (folder) —Å–æ–∑–¥–∞–Ω –≤ Yandex Cloud
