# Food Recognition Service

–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Ö –ë–ñ–£ (–±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã).

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –±–ª—é–¥ –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ª–æ—Ä–∏–π –∏ –ë–ñ–£
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Open Food Facts –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ü§ñ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### 1. Hugging Face ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø - –ë–ï–°–ü–õ–ê–¢–ù–û
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è-–≤—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ë–ï–°–ü–õ–ê–¢–ù–û (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `HUGGINGFACE_API_TOKEN` (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: 
  - ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ
  - ‚úÖ –ü—Ä–æ—â–µ –≤—Å–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å (–º–æ–∂–Ω–æ –≤–æ–æ–±—â–µ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
  - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É
  - ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

### 2. Google Vision API ‚≠ê –ë–ï–°–ü–õ–ê–¢–ù–û (–¥–æ 1000/–º–µ—Å—è—Ü)
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü, –∑–∞—Ç–µ–º $1.50 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è `GOOGLE_VISION_API_KEY`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –•–æ—Ä–æ—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –¢—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ Google Cloud

### 3. OpenAI GPT-4 Vision (–ø–ª–∞—Ç–Ω–æ, —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~$0.01-0.03 –∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (~$10-30 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è `OPENAI_API_KEY`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –°–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –ü–ª–∞—Ç–Ω–æ

### 4. Yandex Vision API (–¥–ª—è –†–æ—Å—Å–∏–∏)
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ë–ï–°–ü–õ–ê–¢–ù–û (–¥–æ 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è `YANDEX_VISION_API_KEY` –∏ `YANDEX_VISION_FOLDER_ID`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –†–æ—Å—Å–∏–∏
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. Hugging Face (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è - –ë–ï–°–ü–õ–ê–¢–ù–û –∏ –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ!)

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–º–æ–∂–Ω–æ –≤–æ–æ–±—â–µ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞):**
```bash
# –í .env –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏—Ç–µ:
AI_PROVIDER=huggingface
# –¢–æ–∫–µ–Ω –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ª—É—á—à–µ–π —Ä–∞–±–æ—Ç—ã
HUGGINGFACE_API_TOKEN=hf_–≤–∞—à_—Ç–æ–∫–µ–Ω  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://huggingface.co/
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Access Tokens
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
4. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`: `HUGGINGFACE_API_TOKEN=hf_–≤–∞—à_—Ç–æ–∫–µ–Ω`

**–ì–æ—Ç–æ–≤–æ!** –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏).

### 2. Google Vision API (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - –±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1000/–º–µ—Å—è—Ü)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ [Yandex Cloud](https://console.cloud.yandex.ru/)
2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ (folder) –≤ –æ–±–ª–∞–∫–µ
3. –ü–æ–ª—É—á–∏—Ç–µ Folder ID –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
4. –ü–æ–ª—É—á–∏—Ç–µ OAuth —Ç–æ–∫–µ–Ω –Ω–∞ https://oauth.yandex.ru/
5. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
AI_PROVIDER=yandex
YANDEX_VISION_API_KEY=–≤–∞—à_oauth_—Ç–æ–∫–µ–Ω
YANDEX_VISION_FOLDER_ID=–≤–∞—à_folder_id
```

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Google Cloud Console
2. –í–∫–ª—é—á–∏—Ç–µ Vision API
3. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á
4. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
AI_PROVIDER=google
GOOGLE_VISION_API_KEY=your_api_key
GOOGLE_VISION_PROJECT_ID=your_project_id
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ OpenAI (–ø–ª–∞—Ç–Ω–æ, —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)

1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –Ω–∞ https://platform.openai.com/api-keys
2. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å (–º–∏–Ω–∏–º—É–º $5)
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
AI_PROVIDER=openai
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4o
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Yandex Vision (–¥–ª—è –†–æ—Å—Å–∏–∏, —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç fallback

–°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

1. **–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä** (—É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ `AI_PROVIDER`)
2. **–î—Ä—É–≥–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã** (–µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª)
3. **Hugging Face** (–≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑–µ—Ä–≤)

## üìä API

### POST /recognize

–†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –±–ª—é–¥–æ –ø–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "imageUrl": "https://example.com/image.jpg",
  "chatId": 123456789
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "dishName": "–ø–∏—Ü—Ü–∞",
  "confidence": 95,
  "calories": 266,
  "protein": 11,
  "carbs": 33,
  "fats": 10,
  "source": "Open Food Facts",
  "provider": "OpenAI",
  "alternatives": []
}
```

### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞.

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–î–ª—è —Å—Ç–∞—Ä—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Hugging Face** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
- **–î–ª—è –±–æ–ª—å—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Google Vision API** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1,000/–º–µ—Å—è—Ü)
- **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **OpenAI GPT-4 Vision** (—Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π, –Ω–æ –ø–ª–∞—Ç–Ω–æ ~$10-30 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–î–ª—è –†–æ—Å—Å–∏–∏**: –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Yandex Vision API, –Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–æ–∂–Ω–µ–µ

## üí∞ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –°—Ç–æ–∏–º–æ—Å—Ç—å | –õ—É—á—à–µ –¥–ª—è |
|-----------|-----------|-----------|
| **Hugging Face** | **–ë–ï–°–ü–õ–ê–¢–ù–û** | –°—Ç–∞—Ä—Ç, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| Google Vision | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 1000/–º–µ—Å, –∑–∞—Ç–µ–º $1.50/1000 | –†–æ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| OpenAI | ~$10-30 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ | –ü—Ä–æ–¥–∞–∫—à–µ–Ω, –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å |
| Yandex Vision | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 10000/–º–µ—Å | –†–æ—Å—Å–∏—è, –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ |

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ "–í—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω API –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ —Å—á–µ—Ç—É OpenAI/Google
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### OpenAI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `OPENAI_API_KEY` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://platform.openai.com/account/usage
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª—å `gpt-4o` –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –≤–∞—à–µ–º –∞–∫–∫–∞—É–Ω—Ç–µ

### Google Vision –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Vision API –≤–∫–ª—é—á–µ–Ω –≤ Google Cloud Console
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã –Ω–∞ https://console.cloud.google.com/apis/api/vision.googleapis.com/quotas
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–ª—é—á –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### Yandex Vision –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `YANDEX_VISION_FOLDER_ID` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ OAuth —Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Vision API –≤–∫–ª—é—á–µ–Ω –≤ Yandex Cloud
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞—Ç–∞–ª–æ–≥ (folder) —Å–æ–∑–¥–∞–Ω –≤ Yandex Cloud
